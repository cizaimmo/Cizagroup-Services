<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Connexion | CIZA GROUP Services</title>

<style>
body{
margin:0;
min-height:100vh;
display:flex;
align-items:center;
justify-content:center;
background:radial-gradient(circle at top,#06142E,#020617);
font-family:system-ui,-apple-system,Segoe UI,Roboto;
color:white;
}
.card{
width:100%;
max-width:420px;
background:linear-gradient(180deg,#0b1738,#071126);
border-radius:26px;
padding:34px 28px;
box-shadow:0 30px 80px rgba(0,0,0,.6);
border:1px solid rgba(242,184,64,.35);
}
.logo{text-align:center;margin-bottom:18px}
.logo img{height:70px}
h1{text-align:center;color:#F2B840;margin-bottom:6px}
.subtitle{text-align:center;opacity:.9;margin-bottom:26px}
label{display:block;margin-top:14px;font-size:14px}
input{
width:100%;
padding:14px;
margin-top:6px;
border-radius:14px;
border:none;
background:#020617;
color:white;
font-size:15px;
}
button{
margin-top:26px;
width:100%;
padding:16px;
border:none;
border-radius:30px;
background:#F2B840;
color:#000;
font-weight:700;
font-size:16px;
cursor:pointer;
}
#msg{text-align:center;margin-top:14px;font-size:14px}
</style>
</head>

<body>

<div class="card">
  <div class="logo">
    <img src="https://raw.githubusercontent.com/cizaimmo/Cizagroup-Services/af7b0385b79f9f030ce8ee44bca672121d582666/logotransparent.png">
  </div>

  <h1>Connexion s√©curis√©e</h1>
  <p class="subtitle">Acc√©dez √† votre espace CIZA GROUP Services</p>

  <label>Email</label>
  <input id="email" type="email" required>

  <label>Mot de passe</label>
  <input id="password" type="password" required>

  <button onclick="login()">Se connecter</button>

  <div id="msg"></div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";

/* üî• FIREBASE CONFIG ‚Äî NE PAS TOUCHER */
const firebaseConfig = {
  apiKey: "AIzaSyBAiJHbBvRO6cDFpm6C-5mQk6SiTtzcI8o",
  authDomain: "cizagroup-app.firebaseapp.com",
  projectId: "cizagroup-app",
  appId: "1:930936264084:web:5395360e54bf17bf492b81"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

/* üîê LOGIN + REDIRECTION INTELLIGENTE */
window.login = async () => {
  const email = document.getElementById("email").value.trim();
  const password = document.getElementById("password").value.trim();
  const msg = document.getElementById("msg");

  if(!email || !password){
    msg.innerText = "Veuillez remplir tous les champs";
    return;
  }

  msg.innerText = "Connexion en cours...";

  try{
    await signInWithEmailAndPassword(auth, email, password);

    // ‚úÖ MARQUE UTILISATEUR CONNECT√â (WEB SEULEMENT)
    localStorage.setItem("ciza_user_logged", "true");

    // üîÅ REDIRECTION VERS SERVICE DEMAND√â
    const service = localStorage.getItem("ciza_redirect_service");

    if(service){
      localStorage.removeItem("ciza_redirect_service");
      window.location.replace(service);
    }else{
      window.location.replace("portal.html");
    }

  }catch(e){
    msg.innerText = "Email ou mot de passe incorrect ‚ùå";
  }
};
</script>

</body>
</html>
